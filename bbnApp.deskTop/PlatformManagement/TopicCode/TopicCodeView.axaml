<UserControl x:Class="bbnApp.deskTop.PlatformManagement.TopicCode.TopicCodeView"
         xmlns="https://github.com/avaloniaui"
         xmlns:avalonia="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:suki="https://github.com/kikipoulet/SukiUI"
         xmlns:converters="clr-namespace:bbnApp.deskTop.Converters"
         xmlns:theme="clr-namespace:SukiUI.Theme;assembly=SukiUI"
         xmlns:my="clr-namespace:bbnApp.deskTop.Controls"
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
         d:DesignHeight="1080"
         d:DesignWidth="1920"
         xmlns:device="clr-namespace:bbnApp.deskTop.PlatformManagement.TopicCode"
         x:DataType="device:TopicCodeViewModel"
         mc:Ignorable="d">

  <Grid>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="500"></ColumnDefinition>
        <ColumnDefinition Width="*"></ColumnDefinition>
      </Grid.ColumnDefinitions>

      <suki:GlassCard Classes="HeaderCard" Margin="10" Grid.Column="0">
        <suki:GroupBox>
          <suki:GroupBox.Header>

            <UniformGrid Columns="2">

              <StackPanel VerticalAlignment="Center" Orientation="Horizontal" Grid.Column="0">
                <avalonia:MaterialIcon Kind="ListBox" Foreground="{DynamicResource SukiText}"></avalonia:MaterialIcon>
                <TextBlock Foreground="{DynamicResource SukiText}">订阅分类</TextBlock>
              </StackPanel>

              <my:Space HorizontalAlignment="Right" Orientation="Horizontal" VerticalAlignment="Center">

                <Button Classes="Basic" Command="{Binding TopicTreeReloadCommand}">
                  <StackPanel Orientation="Horizontal">
                    <avalonia:MaterialIcon Kind="Refresh" Foreground="{DynamicResource SukiText}"></avalonia:MaterialIcon>
                    <TextBlock Foreground="{DynamicResource SukiText}">重载</TextBlock>
                  </StackPanel>
                </Button>

              </my:Space>

            </UniformGrid>

          </suki:GroupBox.Header>
          <ScrollViewer>
            <TreeView ItemsSource="{Binding TopicTreeSource}" SelectionChanged="TreeView_SelectionChanged">
              <TreeView.ItemTemplate>
                <TreeDataTemplate ItemsSource="{Binding SubItems}">
                  <StackPanel Orientation="Horizontal">
                    <avalonia:MaterialIcon Kind="{Binding IsLeaf,Converter={x:Static converters:BoolToIconConverters.FileLeaf}}"></avalonia:MaterialIcon>
                    <TextBlock Text="{Binding Name}" Foreground="{DynamicResource SukiText}">
                      <avalonia:MaterialIcon Kind="Lock" IsVisible="{Binding IsLock}"></avalonia:MaterialIcon>
                      <TextBlock.ContextMenu>
                        <ContextMenu>
                          <MenuItem Header="删除" Tag="IsDelete" Click="MenuItem_Click">
                            <MenuItem.Icon>
                              <avalonia:MaterialIcon Kind="Delete"></avalonia:MaterialIcon>
                            </MenuItem.Icon>
                          </MenuItem>
                          <MenuItem Header="{Binding IsLock,Converter={x:Static converters:BoolToTextConverters.LockLg }}" Tag="IsLock" Click="MenuItem_Click">
                            <MenuItem.Icon>
                              <avalonia:MaterialIcon Kind="{Binding IsLock,Converter={x:Static converters:BoolToIconConverters.FileLock }}}"></avalonia:MaterialIcon>
                            </MenuItem.Icon>
                          </MenuItem>
                        </ContextMenu>
                      </TextBlock.ContextMenu>
                    </TextBlock>

                  </StackPanel>
                </TreeDataTemplate>
              </TreeView.ItemTemplate>
            </TreeView>
          </ScrollViewer>
        </suki:GroupBox>
      </suki:GlassCard>

      <suki:GlassCard Classes="HeaderCard" Margin="10" Grid.Column="1">
        <suki:GroupBox>
          <suki:GroupBox.Header>
            <UniformGrid Columns="2">

              <StackPanel VerticalAlignment="Center" Orientation="Horizontal" Grid.Column="0">
                <avalonia:MaterialIcon Kind="File" Foreground="{DynamicResource SukiText}"></avalonia:MaterialIcon>

                <TextBlock Foreground="{DynamicResource SukiText}" Text="{Binding TopicCodeSelected.TopicName}"></TextBlock>
                <TextBlock Text="("></TextBlock>
                <TextBlock Text="{Binding TopicCodeSelected.Code}"></TextBlock>
                <TextBlock Text=")"></TextBlock>
                <TextBlock Foreground="{DynamicResource SukiText}">订阅详情</TextBlock>

                <avalonia:MaterialIcon Kind="{Binding TopicCodeSelected.IsLock,Converter={x:Static converters:IntToIconConverters.FileLock}}" Foreground="{DynamicResource SukiText}"></avalonia:MaterialIcon>

              </StackPanel>

              <my:Space HorizontalAlignment="Right" Orientation="Horizontal" VerticalAlignment="Center" Grid.Column="1">

                <Button Classes="Basic" Command="{Binding AddTopicCodeCommand}">
                  <StackPanel Orientation="Horizontal">
                    <avalonia:MaterialIcon Kind="Plus" Foreground="{DynamicResource SukiText}"></avalonia:MaterialIcon>
                    <TextBlock Foreground="{DynamicResource SukiText}">新建</TextBlock>
                  </StackPanel>
                </Button>

                <Button Classes="Basic" Command="{Binding TopicCodeSaveCommand}">
                  <StackPanel Orientation="Horizontal">
                    <avalonia:MaterialIcon Kind="Post" Foreground="{DynamicResource SukiText}"></avalonia:MaterialIcon>
                    <TextBlock Foreground="{DynamicResource SukiText}">保存</TextBlock>
                  </StackPanel>
                </Button>

              </my:Space>

            </UniformGrid>


          </suki:GroupBox.Header>
          
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"></ColumnDefinition>
                <ColumnDefinition Width="*"></ColumnDefinition>
              </Grid.ColumnDefinitions>
          
              <StackPanel Orientation="Vertical" Grid.Column="0">
                <StackPanel Classes="FormCell" Orientation="Horizontal">
                  <TextBlock VerticalAlignment="Center" Foreground="{DynamicResource SukiText}">发布对象：</TextBlock>
                  <ComboBox Width="400"  ItemsSource="{Binding TopicTypeList}" SelectedItem="{Binding TopicTypeListSelected}">
                    <ComboBox.ItemTemplate>
                      <DataTemplate>
                        <TextBlock Text="{Binding Name}"/>
                      </DataTemplate>
                    </ComboBox.ItemTemplate>
                  </ComboBox>
                  <TextBlock VerticalAlignment="Center" Classes="NOTNULL">*</TextBlock>
                </StackPanel>

                <StackPanel Classes="FormCell" Orientation="Horizontal">
                  <TextBlock VerticalAlignment="Center" Foreground="{DynamicResource SukiText}">消息名称：</TextBlock>
                  <TextBox Width="400" Text="{Binding TopicCodeSelected.TopicName}"/>
                  <TextBlock VerticalAlignment="Center" Classes="NOTNULL">*</TextBlock>
                </StackPanel>
                
                <StackPanel Classes="FormCell" Orientation="Horizontal">
                  <TextBlock VerticalAlignment="Center" Foreground="{DynamicResource SukiText}">路由地址：</TextBlock>
                  <TextBox Width="400" Text="{Binding TopicCodeSelected.TopicRoter}"/>
                  <TextBlock VerticalAlignment="Center" Classes="NOTNULL">*</TextBlock>
                </StackPanel>

                <StackPanel Classes="FormCell" Orientation="Horizontal">
                  <TextBlock VerticalAlignment="Center" Foreground="{DynamicResource SukiText}">订阅对象：</TextBlock>
                  <ComboBox Width="400" ItemsSource="{Binding DeviceTypeList}" SelectedItem="{Binding DeviceTypeListSelected}">
                    <ComboBox.ItemTemplate>
                      <DataTemplate>
                        <TextBlock Text="{Binding Name}"/>
                      </DataTemplate>
                    </ComboBox.ItemTemplate>
                  </ComboBox>
                </StackPanel>
                
                <StackPanel Classes="FormCell" Orientation="Horizontal">
                  <TextBlock VerticalAlignment="Center" Foreground="{DynamicResource SukiText}">备注说明：</TextBlock>
                  <TextBox Width="400" Text="{Binding TopicCodeSelected.ReMarks}"  AcceptsReturn="True" TextWrapping="Wrap"/>
                </StackPanel>


                <StackPanel Classes="FormCell" Orientation="Horizontal" >
                  <TextBlock VerticalAlignment="Center" Foreground="{DynamicResource SukiText}">消息锁定：</TextBlock>
                  <ToggleSwitch IsEnabled="False" IsChecked="{Binding TopicCodeSelected.IsLock}"></ToggleSwitch>
                  <TextBlock VerticalAlignment="Center" IsVisible="{Binding TopicCodeSelected.IsLock,Converter={StaticResource IntToBoolConverter}}" Text="{Binding TopicCodeSelected.LockTime}"></TextBlock>
                  <TextBlock VerticalAlignment="Center" IsVisible="{Binding TopicCodeSelected.IsLock,Converter={StaticResource IntToBoolConverter}}" Text="{Binding TopicCodeSelected.LockReason}"></TextBlock>
                </StackPanel>
              
              </StackPanel>
              
              <Grid Grid.Column="1">
              
                <suki:GlassCard Classes="HeaderCard" Margin="10">
                  <suki:GroupBox>
                    <suki:GroupBox.Header>
                          <StackPanel VerticalAlignment="Center" Orientation="Horizontal" Grid.Column="0">
                          <avalonia:MaterialIcon Kind="Devices" Foreground="{DynamicResource SukiText}"></avalonia:MaterialIcon>
                          <TextBlock Foreground="{DynamicResource SukiText}">设备清单</TextBlock>
                        </StackPanel>
                    </suki:GroupBox.Header>
                    <suki:BusyArea Name="BusyImage"
                                 BusyText="设备加载中..."
                                 IsBusy="{Binding IsBusy}">
                      <StackPanel Orientation="Vertical">
                        <ScrollViewer AllowAutoHide="True">
                           <ItemsControl ItemsSource="{Binding TempDeviceList}" >
                            <ItemsControl.ItemTemplate>
                            <DataTemplate>
                              <CheckBox IsThreeState="True" IsChecked="{Binding IsChecked}"  Margin="5">
                                     <StackPanel Orientation="Horizontal">
                                      <TextBlock Text="{Binding DeviceName}"></TextBlock>
                                      <TextBlock Text="{Binding DeviceModel}"></TextBlock>
                                    </StackPanel>
                                   </CheckBox>
                            </DataTemplate>
                            </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                        <Border Margin="0,10" Height="1" Background="{DynamicResource SukiText}" HorizontalAlignment="Stretch"></Border>
                        <TextBlock HorizontalAlignment="Center" Foreground="{DynamicResource SukiText}" VerticalAlignment="Center" >如果订阅时针对特性设备则需要勾选</TextBlock>
                        <TextBlock HorizontalAlignment="Center" Foreground="{DynamicResource SukiText}" VerticalAlignment="Center" >可以勾选多个设备,不勾选默认全部设备</TextBlock>
                      </StackPanel>
                    </suki:BusyArea>
                  </suki:GroupBox>
                </suki:GlassCard>
              
              </Grid>
          
            </Grid>
              
          
        </suki:GroupBox>
      </suki:GlassCard>

    </Grid>

</UserControl>
