<UserControl x:Class="bbnApp.deskTop.PlatformManagement.DictionaryCode.DictionaryCodeView"
         xmlns="https://github.com/avaloniaui"
         xmlns:avalonia="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:suki="https://github.com/kikipoulet/SukiUI"
         xmlns:converters="clr-namespace:bbnApp.deskTop.Converters"
         xmlns:theme="clr-namespace:SukiUI.Theme;assembly=SukiUI"
         xmlns:my="clr-namespace:bbnApp.deskTop.Controls"
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
         d:DesignHeight="400"
         d:DesignWidth="1050"
         xmlns:setting="clr-namespace:bbnApp.deskTop.PlatformManagement.DictionaryCode"
         x:DataType="setting:DictionaryCodeViewModel"
         mc:Ignorable="d">
  <SplitView IsPaneOpen="{Binding IsEdit}"
                   x:Name="DictionaryCodeSplite"
                   DisplayMode="Overlay"
                   PanePlacement="Right"
                   OpenPaneLength="450">
    <SplitView.Pane>
      <ContentControl
          Background="{DynamicResource SukiCardBackground}"
          BorderBrush="{DynamicResource SukiLightBorderBrush}"
          BorderThickness="1"
          Content="{Binding DictionaryContent}"></ContentControl>
    </SplitView.Pane>

    <Grid>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="400"></ColumnDefinition>
        <ColumnDefinition Width="*"></ColumnDefinition>
      </Grid.ColumnDefinitions>

      <suki:GlassCard Classes="HeaderCard" Margin="10" Grid.Column="0">
        <suki:GroupBox>
          <suki:GroupBox.Header>
            
            <UniformGrid Columns="2">

              <StackPanel VerticalAlignment="Center" Orientation="Horizontal" Grid.Column="0">
                <avalonia:MaterialIcon Kind="Database" Foreground="{DynamicResource SukiText}"></avalonia:MaterialIcon>
                <TextBlock Text="{Binding DicSelected.DicName}"></TextBlock>
                <TextBlock Foreground="{DynamicResource SukiText}">字典分类</TextBlock>
              </StackPanel>

              <my:Space HorizontalAlignment="Right" Orientation="Horizontal" VerticalAlignment="Center">

                <Button Classes="Basic" Command="{Binding TreeLoadCommand}">
                  <StackPanel Orientation="Horizontal">
                    <avalonia:MaterialIcon Kind="Refresh" Foreground="{DynamicResource SukiText}"></avalonia:MaterialIcon>
                    <TextBlock Foreground="{DynamicResource SukiText}">重载</TextBlock>
                  </StackPanel>
                </Button>

                <Button Classes="Basic" Command="{Binding NodeAddCommand}">
                  <StackPanel Orientation="Horizontal">
                    <avalonia:MaterialIcon Kind="Plus" Foreground="{DynamicResource SukiText}"></avalonia:MaterialIcon>
                    <TextBlock Foreground="{DynamicResource SukiText}">新建</TextBlock>
                  </StackPanel>
                </Button>

              </my:Space>

            </UniformGrid>
            
          </suki:GroupBox.Header>
          <ScrollViewer>
            <TreeView ItemsSource="{Binding DicTreeSource}" SelectionChanged="TreeView_SelectionChanged">
                <TreeView.ItemTemplate>
                <TreeDataTemplate ItemsSource="{Binding SubItems}">
                  <StackPanel Orientation="Horizontal">
                    <avalonia:MaterialIcon Kind="{Binding IsLeaf,Converter={x:Static converters:BoolToIconConverters.FileLeaf}}"></avalonia:MaterialIcon>
                    <TextBlock Text="{Binding Name}" Foreground="{DynamicResource SukiText}">
                      <avalonia:MaterialIcon Kind="Lock" IsVisible="{Binding IsLock}"></avalonia:MaterialIcon>
                      <TextBlock.ContextMenu>
                      <ContextMenu>
                        <MenuItem Header="修改" Tag="Edit" Click="MenuItem_Click">
                          <MenuItem.Icon>
                            <avalonia:MaterialIcon Kind="Edit"></avalonia:MaterialIcon>
                          </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="删除" Tag="IsDelete" Click="MenuItem_Click">
                          <MenuItem.Icon>
                            <avalonia:MaterialIcon Kind="Delete"></avalonia:MaterialIcon>
                          </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="{Binding IsLock,Converter={x:Static converters:BoolToTextConverters.LockLg }}" Tag="IsLock" Click="MenuItem_Click">
                          <MenuItem.Icon>
                            <avalonia:MaterialIcon Kind="{Binding IsLock,Converter={x:Static converters:BoolToIconConverters.FileLock }}}"></avalonia:MaterialIcon>
                          </MenuItem.Icon>
                        </MenuItem>
                      </ContextMenu>
                    </TextBlock.ContextMenu>  
                    </TextBlock>
                   
                </StackPanel>
                </TreeDataTemplate>
              </TreeView.ItemTemplate>
            </TreeView>
          </ScrollViewer>
        </suki:GroupBox>
      </suki:GlassCard>

      <suki:GlassCard Classes="HeaderCard" Margin="10" Grid.Column="1">
        <suki:GroupBox>
          <suki:GroupBox.Header>
            <UniformGrid Columns="2">

              <StackPanel VerticalAlignment="Center" Orientation="Horizontal" Grid.Column="0">
                <avalonia:MaterialIcon Kind="Database" Foreground="{DynamicResource SukiText}"></avalonia:MaterialIcon>

                <TextBlock Foreground="{DynamicResource SukiText}" Text="{Binding DicSelected.DicName}"></TextBlock>
                <TextBlock Text="("></TextBlock>
                <TextBlock Text="{Binding DicSelected.DicCode}"></TextBlock>
                <TextBlock Text=")"></TextBlock>
                <TextBlock Foreground="{DynamicResource SukiText}">项目清单</TextBlock>
                
                <avalonia:MaterialIcon Kind="{Binding DicSelected.IsLock,Converter={x:Static converters:IntToIconConverters.FileLock}}" Foreground="{DynamicResource SukiText}"></avalonia:MaterialIcon>

              </StackPanel>
                
              <my:Space HorizontalAlignment="Right" Orientation="Horizontal" VerticalAlignment="Center" Grid.Column="1">

                <Button Classes="Basic" Command="{Binding ItemsLoadCommand}">
                  <StackPanel Orientation="Horizontal">
                    <avalonia:MaterialIcon Kind="Reload" Foreground="{DynamicResource SukiText}"></avalonia:MaterialIcon>
                    <TextBlock Foreground="{DynamicResource SukiText}">重载</TextBlock>
                  </StackPanel>
                </Button>

                <Button Classes="Basic" Command="{Binding ItemAddCommand}">
                  <StackPanel Orientation="Horizontal">
                    <avalonia:MaterialIcon Kind="Add" Foreground="{DynamicResource SukiText}"></avalonia:MaterialIcon>
                    <TextBlock Foreground="{DynamicResource SukiText}">新建</TextBlock>
                  </StackPanel>
                </Button>
                
              </my:Space>
              
            </UniformGrid>
            
            
          </suki:GroupBox.Header>

          <DataGrid
            ItemsSource="{Binding ItemData}"
            AutoGenerateColumns="False"
            CanUserReorderColumns="True"
            CanUserResizeColumns="True"
            CanUserSortColumns="True"
            GridLinesVisibility="All"
    >
            <DataGrid.Columns>
              <DataGridTextColumn IsReadOnly="True" Binding="{Binding IdxNum}"  Width="100">
                <DataGridTextColumn.Header>
                  <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock>序号</TextBlock>
                  </StackPanel>
                </DataGridTextColumn.Header>
              </DataGridTextColumn>
              <DataGridTextColumn IsReadOnly="True" Binding="{Binding DicCode}"  Width="120">
                <DataGridTextColumn.Header>
                  <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock>分类代码</TextBlock>
                  </StackPanel>
                </DataGridTextColumn.Header>
              </DataGridTextColumn>
              <DataGridTextColumn IsReadOnly="True" Binding="{Binding ItemName}"  Width="260">
                <DataGridTextColumn.Header>
                  <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock>项目名称</TextBlock>
                  </StackPanel>
                </DataGridTextColumn.Header>
              </DataGridTextColumn>
              <DataGridTextColumn IsReadOnly="True" Binding="{Binding ReMarks}"  Width="240">
                <DataGridTextColumn.Header>
                  <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock>项目说明</TextBlock>
                  </StackPanel>
                </DataGridTextColumn.Header>
              </DataGridTextColumn>

              <DataGridTemplateColumn Header="锁定"  Width="100">
                <DataTemplate>
                  <ToggleSwitch Click="ToggleSwitch_Click" Tag="IsLock" IsChecked="{Binding IsLock,  Converter={StaticResource IntToBoolConverter}}"></ToggleSwitch>
                </DataTemplate>
              </DataGridTemplateColumn>

              <!-- 自定义操作列 -->
              <DataGridTemplateColumn Header="操作" Width="120">

                <DataGridTemplateColumn.CellTemplate>
                  <DataTemplate>
                    <my:Space Orientation="Horizontal">
                      <!-- 修改按钮 -->
                      <Button
                              Classes="Basic"
                              ToolTip.Tip="点击修改"
                              Click="Button_Click"
                              Tag="Edit">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                          <avalonia:MaterialIcon Kind="EditCircle" />
                        </StackPanel>
                      </Button>
                      <!-- 删除按钮 -->
                      <Button
                              Classes="Basic Accent"
                              ToolTip.Tip="点击删除"
                              Click="Button_Click"
                              Tag="IsDelete">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                          <avalonia:MaterialIcon Kind="DeleteCircle" />
                        </StackPanel>
                      </Button>
                    </my:Space>
                  </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
              </DataGridTemplateColumn>

            </DataGrid.Columns>
          </DataGrid>

        </suki:GroupBox>
      </suki:GlassCard>


    </Grid>
  </SplitView>
  
  
</UserControl>
